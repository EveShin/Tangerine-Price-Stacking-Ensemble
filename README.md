# 다중 소스 데이터 통합과 스태킹 앙상블 기법을 활용한 감귤 도매 가격 예측 연구

본 프로젝트는 변동성이 높은 제주 감귤 도매 가격을 정확하게 예측하기 위해 다중 소스 데이터를 통합하고, 기계학습 기반의 스태킹 앙상블(Stacking Ensemble) 모델을 구축한 연구입니다.

---

## 연구 개요

* 데이터 기간: 2021년 1월 ~ 2025년 11월 (약 4.9년)
* 핵심 방법론: 6종의 다중 소스 데이터 통합 및 스태킹 앙상블 기법 적용
* 주요 성과: 최종 Stacking Ensemble 모델을 통해 MAPE 10.91% 달성 (Baseline 대비 약 9.7% 성능 향상)

---

## 시스템 아키텍처 및 주요 기능

### 1. 다중 소스 데이터 통합 (Data Integration)

가격, 공급, 기상, 생산, 수출, 소비 등 6가지 서로 다른 소스의 데이터를 주간 단위로 통합하여 분석에 활용했습니다.

* **결측치 보존 전략**: 도메인 특성을 반영하여 무분별한 보간 대신 유의미한 데이터 상태를 유지했습니다.
* **품질 확보**: 거래가 없는 0원 데이터(전체의 19.24%)를 제거하여 모델의 왜곡을 방지했습니다.

### 2. 특징 공학 (Feature Engineering)

* **시계열 특성**: 가격 및 공급량의 이동 평균(Moving Average), 변화율, 래그(Lag) 변수를 생성했습니다.
* **계절성 반영**: 감귤 가격의 강력한 계절성(계절성 강도 79.2%)을 학습에 반영하기 위한 주기성 피처를 추가했습니다.

### 3. 스태킹 앙상블 모델 (Stacking Ensemble)

* **Base Models**: LightGBM, Random Forest, XGBoost 등 6개 모델 비교 분석
* **Meta Model**: 각 모델의 예측값을 입력으로 하여 최종 가격을 도출하는 스태킹 구조를 채택했습니다.
* **최적화**: 3,072개 조합의 하이퍼파라미터 튜닝을 통해 모델별 성능을 극대화했습니다.

---

## 프로젝트 구조

* `preprocess.py`: 데이터 로드, 전처리, 피처 엔지니어링 및 데이터 분할(Train/Val/Test)을 담당합니다.
* `network.py`: 개별 모델 학습, 스태킹 앙상블 로직 및 성능 평가 지표(MAPE, MAE, RMSE) 계산 함수를 포함합니다.
* `main.py`: 전체 프로세스를 제어하며 단순 평균, 가중 평균, 스태킹 등 다양한 앙상블 실험을 수행합니다.

---

## 실험 결과 요약

| 모델 | MAPE (%) | RMSE | R² |
|------|----------|------|-----|
| LightGBM (Baseline) | 12.08 | 1007.95 | 0.816 |
| **Stacking Ensemble** | **10.91** | **910.82** | **0.849** |

---

## 환경 설정 및 실행 방법

### 요구 사항

* Python 3.8+
* pandas, numpy, scikit-learn, lightgbm, xgboost

### 실행 순서

1. `preprocess.py`를 실행하여 원본 데이터를 통합하고 전처리된 데이터셋을 생성합니다.
2. `main.py`를 실행하여 모델 학습 및 앙상블 분석을 수행하고 최종 결과를 확인합니다.

---

## License

This project is available for academic and research purposes.
